<!doctype html>
<html>
  <head>
    <title>ØªØ´Ø®ÙŠØµ Ø³Ø±ÙŠØ¹</title>
  </head>
  <body>
    <h1>ØªØ´Ø®ÙŠØµ InstagramNewsFeed</h1>
    <div id="logs"></div>

    <script>
      const logs = document.getElementById("logs");

      function log(message) {
        logs.innerHTML += "<p>" + message + "</p>";
        console.log(message);
      }

      log("ğŸ” Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´Ø®ÙŠØµ...");

      // Check localStorage
      const user = localStorage.getItem("barbershop_user");
      const token = localStorage.getItem("barbershop_token");

      log("ğŸ‘¤ User in localStorage: " + (user ? "YES" : "NO"));
      log("ğŸ”‘ Token in localStorage: " + (token ? "YES" : "NO"));

      if (user) {
        try {
          const userData = JSON.parse(user);
          log("ğŸ“§ User email: " + userData.email);
          log("ğŸ­ User role: " + userData.role);
          log("ğŸ†” User ID: " + userData.id);
        } catch (e) {
          log("âŒ Error parsing user data");
        }
      }

      // Test API call
      if (token) {
        log("ğŸ”— Testing API call...");
        fetch("/api/posts/following", {
          headers: {
            Authorization: "Bearer " + token,
          },
        })
          .then((response) => response.json())
          .then((data) => {
            log(
              "âœ… API Response: " +
                JSON.stringify(data).substring(0, 100) +
                "...",
            );
            log("ğŸ“Š Posts count: " + (data.posts ? data.posts.length : 0));
          })
          .catch((error) => {
            log("âŒ API Error: " + error.message);
          });
      }

      log("âœ… ØªØ´Ø®ÙŠØµ Ù…ÙƒØªÙ…Ù„");
    </script>
  </body>
</html>
